%!TEX root = ../bare_jrnl.tex

\subsection{The POPP-Dirichlet}
\label{subsec:popd}

The C-POPP model uses a joint observation model in estimating the parameter $\lambda$ of a Poisson process. A joint observation model is an extension of an observation model where the model provides a probability for a particular combination of binary detections coming from each sensor given the true event as show in Eqn. \ref{eq:joint_sensor_model}.

To construct a joint observation model, one needs to have both detections and the corresponding actual (non-)event as ground truth. Pre-processing involving expert interventions is typically required before the detections and their corresponding ground truth can be further used. Similar to the POPP model, the C-POPP model requires the joint observation model to be accurate to avoid the posterior over $\lambda$ drifting away from the true posterior. If attaining an accurate observation model for the POPP model is a problem, then this becomes more prominent in the case of a joint observation model. This is because the training data needed to construct a joint observation model grows by a factor of two for each sensor involved.       

Similar to the extension from the POPP model to the POPP-Beta model, we can extend the C-POPP joint observation model into a Bayesian estimation problem. In this case the joint observation models ($P_{jnt}(d_{1,k}, \ldots, d_{m,k} ; e_k = 1)$ and $P_{jnt}(d_{1,k}, \ldots, d_{m,k} ; e_k = 0)$) will follow Dirichlet distributions. The Dirichlet distribution is an appropriate distribution since $P_{jnt}$ sets the probabilities of multinomial distributions in Eqn. \ref{eq:codependent_sensor_likelihood} and Dirichlet distributions provide a family of prior probability distributions for the multinomial distribution. The Dirichlet-multinomial conjugacy leads to an analytically tractable compound distribution which is called the Dirichlet-multinomial distribution, where the $\vec{p} = (p_1, \ldots, p_r)$ parameter in the multinomial distribution $Multi(\vec{d} ; c, \vec{p})$ is randomly drawn from a Dirichlet distribution $Dir(\vec{p} ; \vec{\zeta})$. 

\begin{equation}
	\label{eq:beta_binomial_revisit}
	\begin{tabular}{r@{ = }l}
        $P(\vec{d} ; c, \vec{\zeta})$ & $\displaystyle\int P(\vec{d} ; c, \vec{p}) ~ P(\vec{p} ; \vec{\zeta}) ~d\mathbb S_r$ \\ [2ex]
        & $\displaystyle\int Multi(\vec{d} ; c, \vec{p}) ~ Dir(\vec{p} ; \vec{\zeta}) ~d\mathbb S_r$ \\ [2ex]
        & $DM((d_1, \ldots, d_r) ; c, (\zeta_1, \ldots, \zeta_r))$
	\end{tabular}
\end{equation}
\noindent with $\vec{d} = (d_1, \ldots, d_r)$, $\vec{\zeta} = (\zeta_1, \ldots, \zeta_r)$, and $d\mathbb S_r$ denotes integrating $\vec{p}$ with respect to the $(r - 1)$ simplex\footnote{The support of the Dirichlet distribution is the $(r - 1)$-dimensional simplex $\mathbb S_r$; that is, all $r$ dimensional vectors which form a valid probability distribution}.

Given $m$ sensors, a joint observation model is now represented as two Dirichlet distributions: $Dir(\mathcal{E^+} ; \vec{\zeta^+})$, and $Dir(\mathcal{E^-} ; \vec{\zeta^-})$ with $\vec{\zeta^+} = (\zeta^+_0, \ldots, \zeta^+_{(m^2)-1})$ and $\vec{\zeta^-} = (\zeta^-_0, \ldots, \zeta^-_{(m^2)-1})$. $\vec{\zeta^+}$ and $\vec{\zeta^-}$ set the overall shape of the Dirichlet priors, with each $\zeta_q$ term counting the number of times that particular combination of sensor detections were produced given a positive ($\vec{\zeta^+}$, $e=1$) or negative ($\vec{\zeta^-}$, $e=0$) detection.


Given a joint sensor model where its elements follow a Dirichlet density and several Dirichlet-multinomial distributions, which provide an unconditional distribution of $(d_1, \ldots, d_r)$, we replace Eqn. \ref{eq:codependent_sensor_likelihood} with:  

\begin{equation}
	\label{eq:joint_dirichlet_multinomial_distribution}
    \begin{tabular}{r@{=}l}
		$P(\vec{s_i} ; c_i)$ & $\displaystyle\sum_{\vec{s} \in \mathcal{P}(\vec{s'_i})} DM(\vec{s} ; |\vec{s}|, \vec{\zeta^+}) ~ DM(\vec{s'_i}\setminus\vec{s} ; (l - |\vec{s}|), \vec{\zeta^-})$
	\end{tabular}
\end{equation}
\noindent with $s'_i$ and $\mathcal{P}$ as defined in Section~\ref{subsec:cpop}.

% With a joint sensor model following the Dirichlet density, which is conjugated with multinomial distributions into a posterior predictive distribution shown in Eqn. \ref{eq:joint_dirichlet_multinomial_distribution}, a graphical model is shown in Figure \ref{fig:gm_popp_dirichlet}.

The difference between the C-POPP model and the POPP-Dirichlet lies only in Eqn. \ref{eq:codependent_sensor_likelihood} being replaced by \ref{eq:joint_dirichlet_multinomial_distribution}. However, given a certain Dirichlet prior, and limited training data for the sensor model, the POPP-Dirichlet is expected to be more conservative in estimating the posterior $P(\lambda \mid \vec{s})$ over $\lambda$ than the C-POPP model.

% \begin{figure}[t!]
% 	\centering
% 	\begin{tikzpicture}
% 	\tikzstyle{place}=[rectangle,draw=blue,thick,minimum size=5 mm]
% 	\tikzstyle{every label}=[black]
% 	\begin{scope}
%     \node[place](51)[xshift=30mm]{$(\zeta^+_0, \ldots, \zeta^+_{(m^2)-1})$};
%     \node[place](52)[right of=51, xshift=30mm]{$(\zeta^-_0, \ldots, \zeta^-_{(m^2)-1})$};
%     \node[place](41)[above of=51, yshift=3mm]{$(E^+_0, \ldots, E^+_{(m^2)-1})$} edge[pre](51);
%     \node[place](42)[above of=52, yshift=3mm]{$(E^-_0, \ldots, E^-_{(m^2)-1})$} edge[pre](52);
%     \node[place](31)[above of=41, xshift=-30mm, yshift=3mm]{$S_{1i}$} edge[pre](41) edge[pre](42);
% 	\node[place](32)[right of=31, xshift=20mm]{$S_{2i}$} edge[pre](41) edge[pre](42);
% 	\node[place](33)[right of=32, xshift=10mm]{$\ldots$} edge[pre](41) edge[pre](42);
% 	\node[place](34)[right of=33, xshift=15mm]{$S_{(m-1)i}$} edge[pre](41) edge[pre](42);
% 	\node[place](35)[right of=34, xshift=22mm]{$S_{mi}$} edge[pre](41) edge[pre](42);
% 	\node[place](21)[above of=33]{$X_i$} edge[post](31) edge[post](32) edge[post](33) edge[post](34) edge[post](35);
% 	\node[place](11)[above of=21]{$\lambda$} edge[post](21);
% 	% \node[place](01)[above of=11]{$\alpha, \beta$} edge[post](11);
% 	\end{scope}
% 	\end{tikzpicture}
% 	\caption{Graphical representation of the POPP-Dirichlet.}
% 	\label{fig:gm_popp_dirichlet}
% \end{figure}
