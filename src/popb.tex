%!TEX root = ../bare_jrnl.tex

\subsection{The POPP-Beta}
\label{subsec:popb}

The POPP model requires the true positive and false positive rates to the specified for sensor $j$, i.e.  $\tau_j = P_j(d;e=1)$ and $\xi_j = P_j(d;e=0)$. 
The POPP model requires these rates to be accurate in order to generate correct posteriors over $\lambda$. To accurately determine the rates in practice, one needs to have a large data set of both sensed counts and the ground truth. Given the ground truth is typically manually created, this places a lot of burden on experts who need to label the data.   

Here, we extend the original POPP model to take into account uncertainty in the true and false positive rates due to limited training data.
% 
To model this uncertainty we use Bayesian estimation to determine the 
true positive rate ($\tau$) and false positive rate ($\xi$)
% 
We use Beta distributions as priors for $\tau$ and $\xi$ because the beta distribution act as a conjugate to the binomial distribution, providing a family of prior probability distributions for the parameter of a binomial distribution. The beta-binomial conjugacy leads to an analytically tractable compound distribution called the beta-binomial distribution ($BB(d ; c, \zeta, \eta)$), where the $p$ parameter in the binomial distribution $B(d ; c, p)$ is drawn from a beta distribution $Be(p ; \zeta, \eta)$.

% \begin{equation}
% 	\label{eq:beta_binomial}
% 	\begin{tabular}{r@{ = }l}
% 		$P(d ; c, \zeta, \eta)$ & $\displaystyle\int_{0}^{1} P(d ; c, p) ~ P(p ; \zeta, \eta) ~dp$ \\ [2ex]
% 		& $\displaystyle\int_{0}^{1} B(d ; c, p) ~ Be(p ; \zeta, \eta) ~dp$ \\ [2ex]
%         & $\displaystyle\int_{0}^{1} \binom{c}{d} p^d (1-p)^{(c-d)} ~ \displaystyle\frac{p^{(\zeta - 1)} (1-p)^{(\eta-1)}}{\pi(\zeta, \eta)}$ \\ [2ex]
%         & $\displaystyle\binom cd \displaystyle\frac{1}{\pi(\zeta, \eta)} \displaystyle\int_{0}^{1} p^{(d+\zeta-1)} (1-p)^{(c-d+\eta-1)} dp$ \\ [2ex]
%         & $\displaystyle\binom cd \displaystyle\frac{\pi(d+\zeta, c-d+\eta)}{\pi(\zeta, \eta)}$ \\ [2ex]
%         & $BB(d ; c, \zeta, \eta)$
% 	\end{tabular}
% \end{equation}

Our sensor rates are now estimated from two beta distributions: $Be(\tau ; \zeta_{\tau}, \eta_{\tau})$ and $Be(\xi ; \zeta_{\xi}, \eta_{\xi})$.
% 
$\zeta_{\tau}$ and $\zeta_{\xi}$ are the number of true positive and false positive detections in the ground truth data respectively.
% 
$\eta_{\tau}$ and $\eta_{\xi}$ are the number of false negative and true  negative detections in the ground truth data respectively. 
% 
Given these parameters, we form the POPP-Beta model from POPP by replacing Eqn. \ref{eq:joint_binomial_distribution} with:  

\begin{equation}
	\label{eq:joint_beta_binomial_distribution}
    P(s_{j,i} ; c_i) \! = \! \! \! \displaystyle\sum_{r = 0}^{c_{i}} \! \! ~ BB\Big(r ; c_i, \zeta_{\tau}, \eta_{\tau}) \Big) BB\Big( (s_{j,i} - r) ; (c_i - r), \zeta_{\xi}, \eta_{\xi}) \Big)
\end{equation}


% With a sensor model which follows beta densities and is fully integrated, as a distribution, in the sensed count likelihood $P(s_{ji} ; c_i)$ as shown in Equation \ref{eq:joint_beta_binomial_distribution}, we obtain a graphical model with the structure shown in Figure \ref{fig:gm_popp_beta}.

One should note that the difference between the POPP and POPP-Beta model, lies only in the change from Eqn. \ref{eq:joint_binomial_distribution} to \ref{eq:joint_beta_binomial_distribution}. However, given little training data for the observation model, the POPP-Beta model is expected to be more conservative in estimating the posterior $P(\lambda ; \vec{s})$ over $\lambda$ than the POPP model. 

% \begin{figure*}[t!]
% 	\centering
% 	\begin{tikzpicture}
% 	\tikzstyle{place}=[rectangle,draw=blue,thick,minimum size=5 mm]
% 	\tikzstyle{empty}=[rectangle,draw=white,thick,minimum size=5 mm]
% 	\tikzstyle{every label}=[black]
% 	\begin{scope}
% 	\node[place](31)[xshift=0mm]{$S_{1i}$};
% 	\node[place](32)[right of=31, xshift=20mm]{$S_{2i}$};
% 	\node[place](33)[right of=32, xshift=20mm]{$\ldots$};
% 	\node[place](34)[right of=33, xshift=20mm]{$S_{(m-1)i}$};
% 	\node[place](35)[right of=34, xshift=22mm]{$S_{mi}$};
% 	\node[place](21)[above of=33]{$X_i$} edge[post](31) edge[post](32) edge[post](33) edge[post](34) edge[post](35);
% 	\node[place](11)[above of=21]{$\lambda$} edge[post](21);
%     \node[place](12)[right of=11, xshift=20mm]{$\textrm{tpr}_{(m-1)}, \textrm{xi}_{(m-1)}$} edge[post](34);
%     \node[place](13)[left of=11, xshift=-20mm]{$\textrm{tpr}_{2}, \textrm{xi}_{2}$} edge[post](32);
%     \node[place](14)[right of=12, xshift=22mm]{$\textrm{tpr}_{m}, \textrm{xi}_{m}$} edge[post](35);
%     \node[place](15)[left of=13, xshift=-20mm]{$\textrm{tpr}_{1}, \textrm{xi}_{1}$} edge[post](31);
% 	\node[empty](01)[above of=11]{};
%     \node[place](02)[above of=12]{$(\zeta, \eta)_{\textrm{tpr}}, (\zeta, \eta)_{\textrm{xi}}$} edge[post](12);
%     \node[place](03)[above of=13]{$(\zeta, \eta)_{\textrm{tpr}}, (\zeta, \eta)_{\textrm{xi}}$} edge[post](13);
%     \node[place](04)[above of=14]{$(\zeta, \eta)_{\textrm{tpr}}, (\zeta, \eta)_{\textrm{xi}}$} edge[post](14);
%     \node[place](05)[above of=15]{$(\zeta, \eta)_{\textrm{tpr}}, (\zeta, \eta)_{\textrm{xi}}$} edge[post](15);
% 	\end{scope}
% 	\end{tikzpicture}
%     \caption{Graphical representation of the POPP-Beta.}
% 	\label{fig:gm_popp_beta}
% \end{figure*}
